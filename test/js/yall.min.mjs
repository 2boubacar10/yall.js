export default function(e){const o=(e=e||{}).lazyClass||"lazy",t=e.lazyBackgroundClass||"lazy-bg",r="idleLoadTimeout"in e?e.idleLoadTimeout:200,n=e.observeChanges||!1,s=e.observerThreshold,a=e.events||{},i=window,l="requestIdleCallback",d="IntersectionObserver",c=["srcset","src","poster"],u=[],b=(e,r)=>u.slice.call((r||document).querySelectorAll(e||"img."+o+",video."+o+",iframe."+o+",."+t)),v=o=>{const r=o.parentNode;let n,s=[];"PICTURE"==r.nodeName&&(n=r),"VIDEO"==o.nodeName&&(n=o),s=b("source",n);for(let e in s)h(s[e]);h(o),o.autoplay&&o.load();const a=o.classList;a.contains(t)&&(a.remove(t),a.add(e.lazyBackgroundLoaded||"lazy-bg-loaded"))},f=e=>{for(let o in a)e.addEventListener(o,a[o].listener||a[o],a[o].options||void 0);m.observe(e)},h=e=>{c.forEach(o=>{o in e.dataset&&i.requestAnimationFrame(()=>{e[o]=e.dataset[o]})})};let g=b();if(/baidu|(?:google|bing|yandex|duckduck)bot/i.test(navigator.userAgent))for(let e in g)v(g[e]);else if(d in i&&d+"Entry"in i){var m=new i[d]((e,t)=>{e.forEach(e=>{if(e.intersectionRatio){const s=e.target;l in i&&r?i[l](()=>{v(s)},{timeout:r}):v(s),s.classList.remove(o),t.unobserve(s),(g=g.filter(e=>e!=s)).length||n||m.disconnect()}})},{rootMargin:("threshold"in e?e.threshold:200)+"px 0%",threshold:s||0});for(let e in g)f(g[e]);n&&new MutationObserver(()=>{b().forEach(e=>{g.indexOf(e)<0&&(g.push(e),f(e))})}).observe(b(e.observeRootSelector||"body")[0],e.mutationObserverOptions||{childList:!0,subtree:!0})}}
