export default function(e){var t=(e=e||{}).lazyClass||"lazy",o=e.lazyBackgroundClass||"lazy-bg",r="idleLoadTimeout"in e?e.idleLoadTimeout:200,a=e.observeChanges||!1,i=e.events||{},n=window,s="requestIdleCallback",d="IntersectionObserver",l=["srcset","src","poster"],v=[],c=(e,r)=>v.slice.call((r||document).querySelectorAll(e||"img."+t+",video."+t+",iframe."+t+",."+o)),u=t=>{var r,a=t.parentNode;"PICTURE"==a.nodeName&&(r=a),"VIDEO"==t.nodeName&&(r=t),m(c("source",r),g),g(t),t.autoplay&&t.load();var i=t.classList;i.contains(o)&&(i.remove(o),i.add(e.lazyBackgroundLoaded||"lazy-bg-loaded"))},b=e=>{for(var t in i)e.addEventListener(t,i[t].listener||i[t],i[t].options||void 0)},g=e=>{var t=t=>{l[t]in e.dataset&&n.requestAnimationFrame(()=>{e.setAttribute(l[t],e.dataset[l[t]])})};for(var o in l)t(o)},m=(e,t)=>{for(var o in e)t instanceof n[d]?t.observe(e[o]):t(e[o])},f=e=>{if(e.isIntersecting||e.intersectionRatio){var o=e.target;s in n&&r?n[s](()=>{u(o)},{timeout:r}):u(o),o.classList.remove(t),p.unobserve(o),(h=h.filter(e=>e!=o)).length||a||p.disconnect()}},y=e=>{h.indexOf(e)<0&&(h.push(e),b(e),p.observe(e))},h=c();if(/baidu|(?:google|bing|yandex|duckduck)bot/i.test(navigator.userAgent))m(h,u);else if(d in n&&d+"Entry"in n){var p=new n[d](e=>{m(e,f)},{rootMargin:("threshold"in e?e.threshold:200)+"px 0%"});m(h,b),m(h,p),a&&m(c(e.observeRootSelector||"body"),t=>{new MutationObserver(()=>{m(c(),y)}).observe(t,e.mutationObserverOptions||{childList:!0,subtree:!0})})}}
